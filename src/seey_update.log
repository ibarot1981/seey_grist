2025-05-21 17:15:24,744 - __main__ - INFO - Starting salary update process...
2025-05-21 17:15:24,744 - __main__ - INFO - Found 1 Excel files to process in ../data/
2025-05-21 17:15:24,744 - __main__ - INFO - 
Processing file: ../data/EmpClockingFormat - 12-5-2025.xlsx
2025-05-21 17:15:24,744 - __main__ - INFO - Extracted month-year from filename: May-25
2025-05-21 17:15:24,744 - __main__ - INFO - Reading master salary sheet...
2025-05-21 17:15:25,078 - __main__ - INFO - Successfully read 2 rows from EmpClockingFormat - 12-5-2025.xlsx
2025-05-21 17:15:25,078 - __main__ - INFO - 
Initializing Grist Updater...
2025-05-21 17:15:25,078 - src.grist_updater - INFO - MarkAsLeft setting: NO
2025-05-21 17:15:25,078 - src.grist_updater - INFO - Using Grist API at: http://safcost.duckdns.org:8484/o/docs/api/docs/wbBN8XZfFRL46umc9Y6yzR
2025-05-21 17:15:25,078 - __main__ - INFO - Starting Grist update process for this file...
2025-05-21 17:15:25,078 - src.grist_updater - INFO - Fetching records from: http://safcost.duckdns.org:8484/o/docs/api/docs/wbBN8XZfFRL46umc9Y6yzR/tables/Emp_Master/records
2025-05-21 17:15:25,222 - src.grist_updater - INFO - Fetched 449 records from Emp_Master
2025-05-21 17:15:25,254 - src.grist_updater - WARNING - Warning: Found 1 rows with 'nan' as employee number. These will be skipped.
2025-05-21 17:15:25,256 - src.grist_updater - INFO - Processing 1 rows from Excel
2025-05-21 17:15:25,256 - src.grist_updater - INFO - Fetching records from: http://safcost.duckdns.org:8484/o/docs/api/docs/wbBN8XZfFRL46umc9Y6yzR/tables/Emp_RateLog/records
2025-05-21 17:15:26,333 - src.grist_updater - INFO - Fetched 280 records from Emp_RateLog
2025-05-21 17:15:26,361 - src.grist_updater - INFO - Employee SF007: No update needed for main table fields.
2025-05-21 17:15:26,361 - src.grist_updater - INFO - No rate log entries to process.
2025-05-21 17:15:26,361 - src.grist_updater - INFO - MarkAsLeft is not YES. Skipping marking employees as left.
2025-05-21 17:15:26,365 - src.grist_updater - INFO - 
--- Update Summary ---
2025-05-21 17:15:26,365 - src.grist_updater - INFO - New employees added to Emp_Master: 0
2025-05-21 17:15:26,365 - src.grist_updater - INFO - Existing employees updated in Emp_Master: 0
2025-05-21 17:15:26,365 - src.grist_updater - INFO - Rate log entries added to Emp_RateLog: 0
2025-05-21 17:15:26,365 - src.grist_updater - INFO - Employees marked as left in Emp_Master: 0
2025-05-21 17:15:26,365 - src.grist_updater - INFO - ----------------------

2025-05-21 17:15:26,365 - __main__ - INFO - Finished processing master sheet for file: EmpClockingFormat - 12-5-2025.xlsx
2025-05-21 17:15:26,365 - __main__ - INFO - 
Processing HourClock sheet...
2025-05-21 17:15:27,176 - src.hourclock_excel_reader - INFO - Total columns in Excel sheet: 74
2025-05-21 17:15:27,223 - src.hourclock_excel_reader - INFO - Generated column names: 74
2025-05-21 17:15:27,954 - src.hourclock_excel_reader - INFO - Before assigning columns: len(new_columns)=74, df.shape[1]=74
2025-05-21 17:15:27,954 - src.hourclock_excel_reader - INFO - DataFrame immediately after reading Excel:
2025-05-21 17:15:27,954 - src.hourclock_excel_reader - INFO - Index(['No', 'SFNo', 'Name', 'P-1', 'OT-1', 'P-2', 'OT-2', 'P-3', 'OT-3',
       'P-4', 'OT-4', 'P-5', 'OT-5', 'P-6', 'OT-6', 'P-7', 'OT-7', 'P-8',
       'OT-8', 'P-9', 'OT-9', 'P-10', 'OT-10', 'P-11', 'OT-11', 'P-12',
       'OT-12', 'P-13', 'OT-13', 'P-14', 'OT-14', 'P-15', 'OT-15', 'P-16',
       'OT-16', 'P-17', 'OT-17', 'P-18', 'OT-18', 'P-19', 'OT-19', 'P-20',
       'OT-20', 'P-21', 'OT-21', 'P-22', 'OT-22', 'P-23', 'OT-23', 'P-24',
       'OT-24', 'P-25', 'OT-25', 'P-26', 'OT-26', 'P-27', 'OT-27', 'P-28',
       'OT-28', 'P-29', 'OT-29', 'P-30', 'OT-30', 'P-31', 'OT-31', 'P-32',
       'OT-32', 'P-33', 'OT-33', 'P-34', 'OT-34', 'P-35', 'OT-35', 'P-36'],
      dtype='object')
2025-05-21 17:15:27,969 - src.hourclock_excel_reader - INFO -   No   SFNo                        Name P-1 OT-1 P-2 OT-2 P-3 OT-3 P-4 OT-4 P-5 OT-5 P-6 OT-6 P-7 OT-7 P-8 OT-8 P-9 OT-9 P-10 OT-10 P-11 OT-11 P-12 OT-12 P-13 OT-13 P-14 OT-14 P-15 OT-15 P-16 OT-16 P-17 OT-17 P-18 OT-18 P-19 OT-19 P-20 OT-20 P-21 OT-21 P-22 OT-22 P-23 OT-23 P-24 OT-24 P-25 OT-25 P-26 OT-26 P-27 OT-27 P-28 OT-28 P-29 OT-29 P-30 OT-30 P-31 OT-31 P-32 OT-32 P-33 OT-33 P-34 OT-34 P-35 OT-35 P-36
0  1  SF007  ARJUNSINH  TAKHATSINH RAJ.   1    2   1    2   1    2   0    0   1    2   0    0   0    0   1    2   1    2    1     2    1     2    1     2    0     0    1     2    1     2    1     2    1     2    1     2    0     5    0     0    0     0    0     0    1     2    1     2    1     2    1     2    0     0    1     2    1     2    1     2    0     0  NaN   NaN  NaN   NaN  NaN   NaN  NaN   NaN  NaN
2025-05-21 17:15:27,985 - src.hourclock_excel_reader - INFO - DataFrame before SFNo filtering:
2025-05-21 17:15:28,001 - src.hourclock_excel_reader - INFO -   No   SFNo                        Name P-1 OT-1 P-2 OT-2 P-3 OT-3 P-4 OT-4 P-5 OT-5 P-6 OT-6 P-7 OT-7 P-8 OT-8 P-9 OT-9 P-10 OT-10 P-11 OT-11 P-12 OT-12 P-13 OT-13 P-14 OT-14 P-15 OT-15 P-16 OT-16 P-17 OT-17 P-18 OT-18 P-19 OT-19 P-20 OT-20 P-21 OT-21 P-22 OT-22 P-23 OT-23 P-24 OT-24 P-25 OT-25 P-26 OT-26 P-27 OT-27 P-28 OT-28 P-29 OT-29 P-30 OT-30 P-31 OT-31 P-32 OT-32 P-33 OT-33 P-34 OT-34 P-35 OT-35 P-36
0  1  SF007  ARJUNSINH  TAKHATSINH RAJ.   1    2   1    2   1    2   0    0   1    2   0    0   0    0   1    2   1    2    1     2    1     2    1     2    0     0    1     2    1     2    1     2    1     2    1     2    0     5    0     0    0     0    0     0    1     2    1     2    1     2    1     2    0     0    1     2    1     2    1     2    0     0  NaN   NaN  NaN   NaN  NaN   NaN  NaN   NaN  NaN
2025-05-21 17:15:28,001 - __main__ - INFO - Successfully read 1 rows from HourClock sheet in EmpClockingFormat - 12-5-2025.xlsx
2025-05-21 17:15:28,001 - __main__ - INFO - 
Initializing HourClock Grist Updater...
2025-05-21 17:15:28,001 - src.hourclock_grist_updater - INFO - Using Grist API at: http://safcost.duckdns.org:8484/o/docs/api/docs/wbBN8XZfFRL46umc9Y6yzR
2025-05-21 17:15:28,001 - src.hourclock_grist_updater - INFO - Targeting HourClock table: HC_Detail
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - Fetched table columns from /columns endpoint: 70 columns
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - Available columns: Month, Month_Year, Name, OT_1, OT_10, OT_11, OT_12, OT_13, OT_14, OT_15, OT_16, OT_17, OT_18, OT_19, OT_2, OT_20, OT_21, OT_22, OT_23, OT_24, OT_25, OT_26, OT_27, OT_28, OT_29, OT_3, OT_30, OT_31, OT_4, OT_5, OT_6, OT_7, OT_8, OT_9, P_1, P_10, P_11, P_12, P_13, P_14, P_15, P_16, P_17, P_18, P_19, P_2, P_20, P_21, P_22, P_23, P_24, P_25, P_26, P_27, P_28, P_29, P_3, P_30, P_31, P_4, P_5, P_6, P_7, P_8, P_9, SFNo, Sr_No, Total_OT, Total_P, Year
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - Found 31 P_* columns: P_1, P_10, P_11, P_12, P_13, P_14, P_15, P_16, P_17, P_18, P_19, P_2, P_20, P_21, P_22, P_23, P_24, P_25, P_26, P_27, P_28, P_29, P_3, P_30, P_31, P_4, P_5, P_6, P_7, P_8, P_9
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - Found 31 OT_* columns: OT_1, OT_10, OT_11, OT_12, OT_13, OT_14, OT_15, OT_16, OT_17, OT_18, OT_19, OT_2, OT_20, OT_21, OT_22, OT_23, OT_24, OT_25, OT_26, OT_27, OT_28, OT_29, OT_3, OT_30, OT_31, OT_4, OT_5, OT_6, OT_7, OT_8, OT_9
2025-05-21 17:15:28,049 - __main__ - INFO - Starting HourClock Grist update process for this file...
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - Excel data columns received by compare_and_update:
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - Index(['No', 'SFNo', 'Name', 'P-1', 'OT-1', 'P-2', 'OT-2', 'P-3', 'OT-3',
       'P-4', 'OT-4', 'P-5', 'OT-5', 'P-6', 'OT-6', 'P-7', 'OT-7', 'P-8',
       'OT-8', 'P-9', 'OT-9', 'P-10', 'OT-10', 'P-11', 'OT-11', 'P-12',
       'OT-12', 'P-13', 'OT-13', 'P-14', 'OT-14', 'P-15', 'OT-15', 'P-16',
       'OT-16', 'P-17', 'OT-17', 'P-18', 'OT-18', 'P-19', 'OT-19', 'P-20',
       'OT-20', 'P-21', 'OT-21', 'P-22', 'OT-22', 'P-23', 'OT-23', 'P-24',
       'OT-24', 'P-25', 'OT-25', 'P-26', 'OT-26', 'P-27', 'OT-27', 'P-28',
       'OT-28', 'P-29', 'OT-29', 'P-30', 'OT-30', 'P-31', 'OT-31', 'P-32',
       'OT-32', 'P-33', 'OT-33', 'P-34', 'OT-34', 'P-35', 'OT-35', 'P-36'],
      dtype='object')
2025-05-21 17:15:28,049 - src.hourclock_grist_updater - INFO - First 5 rows of excel_data received by compare_and_update:
2025-05-21 17:15:28,065 - src.hourclock_grist_updater - INFO -   No   SFNo                        Name P-1 OT-1 P-2 OT-2 P-3 OT-3 P-4 OT-4 P-5 OT-5 P-6 OT-6 P-7 OT-7 P-8 OT-8 P-9 OT-9 P-10 OT-10 P-11 OT-11 P-12 OT-12 P-13 OT-13 P-14 OT-14 P-15 OT-15 P-16 OT-16 P-17 OT-17 P-18 OT-18 P-19 OT-19 P-20 OT-20 P-21 OT-21 P-22 OT-22 P-23 OT-23 P-24 OT-24 P-25 OT-25 P-26 OT-26 P-27 OT-27 P-28 OT-28 P-29 OT-29 P-30 OT-30 P-31 OT-31 P-32 OT-32 P-33 OT-33 P-34 OT-34 P-35 OT-35 P-36
0  1  SF007  ARJUNSINH  TAKHATSINH RAJ.   1    2   1    2   1    2   0    0   1    2   0    0   0    0   1    2   1    2    1     2    1     2    1     2    0     0    1     2    1     2    1     2    1     2    1     2    0     5    0     0    0     0    0     0    1     2    1     2    1     2    1     2    0     0    1     2    1     2    1     2    0     0  NaN   NaN  NaN   NaN  NaN   NaN  NaN   NaN  NaN
2025-05-21 17:15:28,065 - src.hourclock_grist_updater - INFO - P columns in Excel: P-1, P-10, P-11, P-12, P-13, P-14, P-15, P-16, P-17, P-18, P-19, P-2, P-20, P-21, P-22, P-23, P-24, P-25, P-26, P-27, P-28, P-29, P-3, P-30, P-31, P-32, P-33, P-34, P-35, P-36, P-4, P-5, P-6, P-7, P-8, P-9
2025-05-21 17:15:28,065 - src.hourclock_grist_updater - INFO - OT columns in Excel: OT-1, OT-10, OT-11, OT-12, OT-13, OT-14, OT-15, OT-16, OT-17, OT-18, OT-19, OT-2, OT-20, OT-21, OT-22, OT-23, OT-24, OT-25, OT-26, OT-27, OT-28, OT-29, OT-3, OT-30, OT-31, OT-32, OT-33, OT-34, OT-35, OT-4, OT-5, OT-6, OT-7, OT-8, OT-9
2025-05-21 17:15:28,065 - src.hourclock_grist_updater - INFO - Fetching existing records from: http://safcost.duckdns.org:8484/o/docs/api/docs/wbBN8XZfFRL46umc9Y6yzR/tables/HC_Detail/records with filter Month_Year = May-25
2025-05-21 17:15:28,097 - src.hourclock_grist_updater - INFO - Fetched 0 existing records for May-25 from HC_Detail
2025-05-21 17:15:28,210 - src.hourclock_grist_updater - INFO - No existing records found in Grist table HC_Detail for May-25. All records will be added as new.
2025-05-21 17:15:28,210 - src.hourclock_grist_updater - INFO - Processing 1 valid rows from HourClock Excel sheet
2025-05-21 17:15:28,226 - src.hourclock_grist_updater - INFO - Attempting to add new HourClock record for employee SF007 (May-25).
2025-05-21 17:15:28,226 - src.hourclock_grist_updater - INFO - Adding 1 new HourClock records to HC_Detail.
2025-05-21 17:15:28,505 - src.hourclock_grist_updater - INFO - Successfully added 1 new HourClock records.
2025-05-21 17:15:28,505 - src.hourclock_grist_updater - INFO - 
--- HourClock Update Summary ---
2025-05-21 17:15:28,505 - src.hourclock_grist_updater - INFO - New HourClock records added: 1
2025-05-21 17:15:28,505 - src.hourclock_grist_updater - INFO - Existing HourClock records updated: 0
2025-05-21 17:15:28,505 - src.hourclock_grist_updater - INFO - ------------------------------

2025-05-21 17:15:28,505 - __main__ - INFO - Finished processing HourClock sheet for file: EmpClockingFormat - 12-5-2025.xlsx
2025-05-21 17:15:28,505 - __main__ - INFO - 
All Excel files processed.
2025-05-21 17:15:28,505 - __main__ - INFO - 
All Excel files processed.
